"0","estimate_BH_fdr <- function(alpha, pi_zero, sigma_b, num_sims = 100) {"
"0","  "
"0","  exp_fdr <- 0"
"0","  "
"0","  for(sim in seq(1, num_sims)){"
"0","    "
"0","    # this should just be simple calls to the functions above"
"0","    data <- simulate_data(pi_zero = pi_zero, mixt_sd = sigma_b)"
"0","    p_vals <- comp_p_val(data$D)"
"0","    test_results <- apply_BH(alpha, p_vals)"
"0","    exp_fdr <- exp_fdr + (1 / num_sims) * e_fdr(data$beta, test_results)"
"0","  "
"0","  }"
"0","  "
"0","  return(exp_fdr)"
"0","  "
"0","}"
