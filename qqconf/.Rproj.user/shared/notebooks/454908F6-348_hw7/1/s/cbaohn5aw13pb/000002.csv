"0","apply_BH <- function(alpha, p_vals) {"
"0","  "
"0","  num_p_vals <- length(p_vals)"
"0","  p_df <- data.frame(p = p_vals, test = seq(1, num_p_vals))"
"0","  p_df <- p_df %>% arrange(p)"
"0","  bh_cutoff <- (seq(1, num_p_vals) / num_p_vals) * alpha"
"0","  max_true <- 0"
"0","  "
"0","  for(i in seq(from = num_p_vals, to = 1, by = -1)){"
"0","    "
"0","    if(p_df$p[i] < bh_cutoff[i]) {"
"0","      "
"0","      max_true <- i"
"0","      break"
"0","      "
"0","    }"
"0","    "
"0","  }"
"0","  "
"0","  gamma_vec <- c(rep(1, max_true), rep(0, (num_p_vals - max_true)))"
"0","  p_df <- p_df %>%"
"0","    mutate(gamma = gamma_vec) %>%"
"0","    arrange(test)"
"0","  "
"0","  return(p_df$gamma)"
"0","  "
"0","}"
