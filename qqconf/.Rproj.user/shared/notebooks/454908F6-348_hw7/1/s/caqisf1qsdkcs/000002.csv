"0","simulate_data <- function(pi_zero, mixt_sd, n = 10, m = 1000) {"
"0","  "
"0","  beta_vec <- numeric(m)"
"0","  for(i in seq(from = 1, to = m)) {"
"0","    "
"0","    beta_vec[i] <- (runif(1) > pi_zero) * rnorm(n = 1, mean = 0, sd = mixt_sd)"
"0","    "
"0","  }"
"0","  "
"0","  D_mat <- matrix(nrow = n, ncol = m)"
"0","  # now, have the beta vec, need to generate the D-matrix"
"0","  for(j in seq(from = 1, to = m)) {"
"0","    "
"0","    D_mat[, j] <- rnorm(n = n, mean = beta_vec[j])"
"0","    "
"0","  }"
"0","  return(list(D = D_mat, beta = beta_vec))"
"0","  "
"0","}"
