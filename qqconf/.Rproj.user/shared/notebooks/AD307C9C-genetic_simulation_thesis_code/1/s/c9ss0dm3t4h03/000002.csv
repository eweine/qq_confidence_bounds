"0","sim_from_genetic_model <- function(num_ppl, num_genes, prop_true, true_var, noise_var) {"
"0","  "
"0","  # First, simulate from the signals"
"0","  true_vec <- rnorm(n = num_genes, mean = 0, sd = true_var)"
"0","  sigs <- runif(n = num_genes)"
"0","  sig_true <- as.numeric(sigs <= prop_true)"
"0","  signal_vec <- true_vec * sig_true"
"0","  "
"0","  total_data <- rbinom(n = num_ppl * num_genes, size = 2, prob = .3)"
"0","  G_mat <- matrix(data = total_data, nrow = num_ppl, ncol = num_genes)"
"0","  signal_col <- matrix(data = signal_vec, ncol = 1)"
"0","  "
"0","  Y_vec <- G_mat %*% signal_col + rnorm(n = num_ppl, mean = 0, sd = sqrt(noise_var))"
"0","  "
"0","  "
"0","  return(list(Y = Y_vec, G = G_mat))"
"0","  "
"0","}"
