"0","normalize_prob <- function(prob_vec) {"
"0","  "
"0","  prob_vec / sum(prob_vec)"
"0","  "
"0","}"
"0","z_liklihood <- function(p, f, g, z) {"
"0","  "
"0","  lik <- 1"
"0","  if(z == 1) {"
"0","    "
"0","    lik <- lik * f"
"0","    "
"0","    if(g == ""AA""){"
"0","      "
"0","      lik <- lik * p"
"0","      "
"0","    } else if(g == ""aa"") {"
"0","      "
"0","      lik <- lik * (1 - p)"
"0","      "
"0","    } else {"
"0","      "
"0","      lik <- 0"
"0","      "
"0","    }"
"0","    "
"0","  } else {"
"0","    "
"0","    if(g == ""Aa"") {"
"0","      "
"0","      lik <- lik * 2 * p * (1 - p)"
"0","      "
"0","    } else {"
"0","      "
"0","      lik <- lik * ((1 - p) ^ 2) "
"0","      "
"0","    }"
"0","    "
"0","  }"
"0","  "
"0","  return(lik)"
"0","  "
"0","}"
"0","sample_z <- function(p, f, g_vec) {"
"0","  "
"0","  n <- length(g_vec)"
"0","  z_samp <- numeric(n)"
"0","  for(i in seq(from = 1, to = n, by = 1)) {"
"0","    "
"0","    zero_prob <- z_liklihood(p, f, g_vec[i], 0)"
"0","    one_prob <- z_liklihood(p, f, g_vec[i], 1)"
"0","    z_samp[i] <- sample(c(0, 1), 1, "
"0","                        prob = normalize_prob(c(zero_prob, one_prob)))"
"0","    "
"0","  }"
"0","  "
"0","  return(z_samp)"
"0","  "
"0","}"
