"0","mh_normal_means <- function(num_iter = 1000, mu_start, eta_start, "
"0","                            mu_sd, eta_sd, x_vec, s_vec) {"
"0","  "
"0","  mu_samp <- numeric(num_iter)"
"0","  eta_samp <- numeric(num_iter)"
"0","  mu_samp[1] <- mu_start"
"0","  eta_samp[1] <- eta_start"
"0","  for(i in seq(from = 2, to = num_iter, by = 1)) {"
"0","    "
"0","    current_mu <- mu_samp[i - 1]"
"0","    current_eta <- eta_samp[i - 1]"
"0","    new_mu <- current_mu + rnorm(n = 1, mean = 0, sd = mu_sd)"
"0","    new_eta <- current_eta + rnorm(n = 1, mean = 0, sd = eta_sd)"
"0","    A_mu <- exp(log_lik_normal_hier(x_vec = x_vec, s_vec = s_vec, "
"0","                                    mu = new_mu, eta = current_eta) -"
"0","                log_lik_normal_hier(x_vec = x_vec, s_vec = s_vec, "
"0","                                    mu = current_mu, eta = current_eta) )"
"0","    "
"0","    if(runif(1) < A_mu) {"
"0","      "
"0","      mu_samp[i] <- new_mu"
"0","      "
"0","    }"
"0","    "
"0","    A_eta <- exp(log_lik_normal_hier(x_vec = x_vec, s_vec = s_vec, "
"0","                                     mu = mu_samp[i], eta = new_eta) -"
"0","                log_lik_normal_hier(x_vec = x_vec, s_vec = s_vec, "
"0","                                    mu = mu_samp[i], eta = current_eta) )"
"0","    "
"0","    if(runif(1) < A_eta) {"
"0","      "
"0","      eta_samp[i] <- new_eta"
"0","      "
"0","    }"
"0","    "
"0","  }"
"0","  "
"0","  return(list(mu = mu_samp, eta = eta_samp))"
"0","  "
"0","}"
