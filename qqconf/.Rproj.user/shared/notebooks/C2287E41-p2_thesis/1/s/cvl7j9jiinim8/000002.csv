"0","local_eta_two_sided <- function(alpha, n, tol = 1e-8, max_it = 50) {"
"0","  eta_high <- asymp_eta(alpha, n)"
"0","  eta_low <- alpha / n"
"0","  eta_curr <- eta_low + (eta_high - eta_low) / 2"
"0","  n_it <- 0"
"0","  "
"0","  while (n_it < max_it) {"
"0","    "
"0","    n_it <- n_it + 1"
"0","    h_vals <- qbeta(eta_curr / 2, 1:n, n:1)"
"0","    g_vals <- qbeta(1 - (eta_curr / 2), 1:n, n:1)"
"0","    test_alpha <- 1 - fast_jointlevel_twosided_exact(h_vals, g_vals)"
"0","    "
"0","    if (abs(test_alpha - alpha) / alpha <= tol) break"
"0","    "
"0","    if (test_alpha > alpha) {"
"0","      "
"0","        eta_high <- eta_curr"
"0","        eta_curr <- eta_curr - (eta_curr - eta_low) / 2"
"0","              "
"0","    } else if (test_alpha < alpha) {"
"0","            "
"0","        eta_low <- eta_curr"
"0","        eta_curr <- eta_curr + (eta_high - eta_curr) / 2"
"0","              "
"0","      }"
"0","    "
"0","  }"
"0","  "
"0","  return(eta_curr)"
"0","  "
"0","}"
