#+Title:	Make QQ plots of CJD data subset
#+Author:	Mark Abney
#+Email:	mark.a.abney@gmail.com
#+Date:		2020-12-18

#+Startup: latexpreview
#+Property: header-args :session *R:cjd* :results output

* Read in data and R functions

#+begin_src R :results silent
  cjd.df <- read.table("Data/cjd_sample.txt", header = TRUE)
  
#+end_src

#+begin_src R :results silent
  devtools::load_all("../qqconf")
  ## source("qq_plots.R")  
#+end_src

* Make plots

** QQ plots of CJD data
   #+name: qq-log10
   #+begin_src R :results graphics file :file Figures/qq-log10.png
     source("qq_plots.R")
     pdf("qq_cjd.pdf")     
     qq_conf_plot(cjd.df[,3], pw.lty = 0, pch = 21, cex = 0.2)
     qq_conf_plot(cjd.df[,3], pw.lty = 0, pch = 21, cex = 0.2, difference = TRUE)
     qq_conf_plot(cjd.df[,3], log10 = TRUE, pw.lty = 0, pch = 21, cex = 0.2)
     qq_conf_plot(cjd.df[,3], log10 = TRUE, pw.lty = 0, pch = 21, cex = 0.2,
                  difference = TRUE, ylim = c(-0.2, 1.1))
     dev.off()     
                                        #x # Do nothing     
   #+end_src
   
   #+begin_src R :noweb yes :results graphics file :file Figures/qq-log10.pdf
     <<qq-log10>>
   #+end_src

** QQ plot of points from a chi square distribution
#+begin_src R :results silent
  y <- rchisq(1000, df = 3)
  qq_conf_plot(y, qchisq, dist.params = list(df = 2), difference = TRUE)  
#+end_src

** Example QQ plot
#+begin_src R :results silent
  y <- runif(293)
  qq_conf_plot(y, difference = TRUE, log10 = TRUE, bounds.params = list(method = "search"), pch=3)
#+end_src

